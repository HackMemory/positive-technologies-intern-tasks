# Задача

Разработать python-скрипт, позволяющий автоматизировать атаку словарного подбора паролей пользователей уязвимого приложения VulPy (https://github.com/fportantier/vulpy). В качестве словаря необходимо использовать: https://drive.google.com/file/d/1kAxYJ3kVrM141JZO8XrncwoTH4cmXf_S/view?usp=sharing. 

Дополнительное задание:

Исследовать уязвимую и неуязвимую версии приложения vulpy (например, с помощью утилит https://winmerge.org/downloads/ или https://download.kde.org/stable/kdiff3/) и подготовить описание в свободной форме, каким образом в неуязвимой версии устранена данная уязвимость.

# Запуск

```
python task2.py <host> <username> <password_file> [num_threads=1]
```

# Иследование уязвимости

Проведя анализ двух версий приложения с точки зрения уязвимости в отношении подбора пароля, я не обнаружил конкретных изменений, которые могли бы предотвратить атаку методом брутфорса. При тестировании скрипта для брутфорса на версии приложения без уязвимостей, скрипт успешно осуществил взлом пароля.

Единственным отличием между версиями заключается в том, что процесс авторизации в неуязвимой версии занимает немного больше времени. Это обусловлено тем, что в неуязвимой версии пароли хранятся в хешированном виде в базе данных, и при каждом запросе пароль подвергается хешированию, что замедляет процесс:

https://github.com/fportantier/vulpy/blob/5249cc8b05a1c37f6b2f757b1cf16a509c327122/good/libuser.py#L28

```python
backend = default_backend()

kdf = Scrypt(
    salt=unhexlify(user['salt']),
    length=32,
    n=2**14,
    r=8,
    p=1,
    backend=backend
)

try:
    kdf.verify(password.encode(), unhexlify(user['password']))
    #print('valid')
    return username
except InvalidKey:
    #print('invalid1')
    return False
except Exception as e:
    #print('invalid2', e)
    return False
```

Помимо вышеупомянутых изменений, для полной защиты от атак методом брутфорса внедрена система входа по одноразовому паролю (OTP). Это дополнительное средство безопасности должно эффективно сдерживать подобные атаки, предоставляя либо одноразовые пароли для каждой сессии, либо блокируя повторяющиеся запросы на авторизацию.
